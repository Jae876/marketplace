COMPLETE SEAMLESS WORKFLOW - STEP BY STEP TESTING GUIDE
=====================================================

✅ ALL FIXES APPLIED - READY FOR TESTING

STEP 1: ADMIN SETUP
===================
1. Go to /admin/login
2. Enter admin password (set in environment)
3. Should redirect to /admin
4. Click "Add Product"
5. Fill in:
   - Name: Test Product
   - Description: Test product description
   - Price: 100 (USD value)
   - Region: North America
   - Type: Digital Account
   - Size (optional): 5 (number of pieces available)
   - Image URL: https://via.placeholder.com/400x300?text=Product (or any valid image URL)
6. Click "Create Product"
7. ✅ EXPECTED: Product created, success message shown

STEP 2: VERIFY PRODUCT IS VISIBLE TO USER
==========================================
1. Open new browser / incognito window
2. Go to /dashboard or /
3. Should see list of products
4. Product should show:
   - Product name
   - Description
   - Price
   - Image (from URL you entered)
   - Region, Type, Pieces Available
5. ✅ EXPECTED: Product fully visible with image

STEP 3: USER CLICKS ON PRODUCT
==============================
1. Click on the product card/image
2. Should navigate to /product/[id]
3. Page should show:
   - Product image at top
   - Product name
   - Full description
   - Price, Region, Type, Size
4. ✅ EXPECTED: No "product not found" error, all details load

STEP 4: USER CLICKS "BUY NOW"
============================
1. User should be logged in (sign up if not)
2. Click "Buy Now" button on product page
3. Cryptocurrency dropdown should appear
4. ✅ EXPECTED: Dropdown shows Bitcoin, Ethereum, etc.

STEP 5: USER SELECTS CRYPTOCURRENCY
===================================
1. Select a cryptocurrency (e.g., Bitcoin)
2. If cryptocurrency has multiple networks (e.g., Ethereum on Ethereum/Polygon):
   - Network selector appears
   - Select desired network
3. Page should show:
   - Wallet address (generated by admin)
   - Amount to pay (in USD first, then convert to crypto)
   - Quantity selector
4. ✅ EXPECTED: Wallet address displays, amount calculated

STEP 6: REAL-TIME CONVERSION
===========================
1. Amount should show in USD first
2. Below should show equivalent in selected crypto:
   - E.g., "$100.00 USD = 0.0024 BTC"
3. If user changes quantity:
   - Amount recalculates in real-time
   - E.g., "$300.00 USD = 0.0072 BTC"
4. ✅ EXPECTED: Live conversion works seamlessly

STEP 7: USER CONFIRMS DEPOSIT
=============================
1. User clicks "Confirm Deposit Sent"
2. Transaction created with status: "pending"
3. User receives notification in message icon
4. ✅ EXPECTED: Notification appears in top-left message icon

STEP 8: ADMIN RECEIVES ORDER NOTIFICATION
==========================================
1. Admin logs in to /admin/orders
2. Should see order in "Paid Orders Ready for Delivery"
3. Order details shown:
   - Buyer name/email
   - Product name
   - Amount
   - Cryptocurrency
4. ✅ EXPECTED: Order appears without needing refresh

STEP 9: ADMIN SENDS ITEM TO BUYER
==================================
1. Admin clicks "Send Item" button on order
2. Dialog appears to enter item content
3. Admin enters item details (e.g., account credentials, link, etc.)
4. Admin clicks "Send"
5. ✅ EXPECTED: Item sent successfully, message shown

STEP 10: USER RECEIVES ITEM DELIVERY NOTIFICATION
==================================================
1. User checks message icon (top-left bell)
2. New notification appears: "Item Delivered"
3. User can click to view delivered item details
4. User clicks "Confirm Delivery"
5. ✅ EXPECTED: Item marked as confirmed, notification updates

STEP 11: FUNDS RELEASED - BALANCE UPDATES
==========================================
1. After user confirms delivery:
   - Transaction status changes to: "paid"
   - User receives notification: "Funds Released to Seller"
2. ✅ Check Balance Badge:
   - Shows updated balance
   - Shows recent deposit with pulse animation
   - Displays trust score
3. ✅ EXPECTED: Balance updated, notifications clear

STEP 12: ADMIN VERIFIES PAYMENT RECEIVED
=========================================
1. Admin can see in /admin/orders:
   - Order status changed to "delivered"
   - Payment confirmed
2. ✅ EXPECTED: No errors, all statuses update correctly

ERROR CHECKS - IF PRODUCT NOT FOUND
====================================
If user sees "product not found" when clicking product:

1. Check product was created (admin can see it in /admin/products)
2. Verify product ID in URL matches database
3. Check JSON database has product:
   - Local: data/products.json should have product
   - Vercel: PostgreSQL should have record in products table
4. If using Vercel Neon:
   - Check DATABASE_URL environment variable is set
   - Check Neon database has products table created
   - Verify product record exists in database

IMAGE URL NOT SHOWING
=====================
1. Verify image URL is publicly accessible:
   - Test URL in browser - should load image
   - Not localhost or private server
2. Check CORS - image should be from public source
3. Verify URL format is correct (http:// or https://)
4. Common working image URLs:
   - https://via.placeholder.com/400x300
   - https://picsum.photos/400/300
   - Any public image hosting (imgur, cloudinary, etc.)

WALLET ADDRESS NOT SHOWING
===========================
1. Admin must set wallet config first:
   - Go to /admin (wallet settings)
   - Add wallet addresses for cryptocurrencies
   - E.g., Bitcoin: 1A1z7agoat2Bt3zzQZXjxkCisUg7DsitkE
2. User selects cryptocurrency:
   - Must have wallet address configured by admin
   - Otherwise shows: "Wallet address not configured"
3. Fix: Admin adds wallet → try again

AMOUNT NOT CALCULATING CORRECTLY
================================
1. Verify product price is a number
2. Verify quantity selector works
3. Amount = product.price * quantity
4. Conversion to crypto uses real-time rates
5. If broken:
   - Check console for errors
   - Verify payment/create API returns correct amount
   - Verify cryptocurrency library working

NOTIFICATIONS NOT APPEARING
===========================
1. Check message icon has notification dot
2. Click message icon to open modal
3. Should show:
   - Welcome message (on signup)
   - Deposit confirmation (when admin confirms)
   - Item delivery (when admin sends item)
   - Fund release (when user confirms delivery)
4. If missing:
   - Check localStorage has user token
   - Verify /api/messages endpoint returns messages
   - Check database has item_messages table

BALANCE NOT UPDATING
====================
1. After deposit confirmed:
   - Wait a moment for database update
   - Refresh page
   - Check Balance Badge
2. Should show:
   - Updated balance
   - Deposit amount listed
   - Trust score updated
3. If not updating:
   - Check /api/user/profile returns correct balance
   - Verify /api/payment/confirm PUT updated database
   - Check user record in database has new balance

==========================================
✅ IF ALL STEPS PASS: SYSTEM IS WORKING PERFECTLY
✅ READY FOR PRODUCTION DEPLOYMENT
==========================================
